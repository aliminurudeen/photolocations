(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{127:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n.n(o),i=n(1),a=n.n(i);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function l(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=["click","dblclick","dragend","mousedown","mouseout","mouseover","mouseup","recenter"],d=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),l(this,u(t).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,r.a.Component),function(e,t,n){t&&s(e.prototype,t),n&&s(e,n)}(t,[{key:"componentDidMount",value:function(){this.markerPromise=function(){var e={},t=new Promise(function(t,n){e.resolve=t,e.reject=n});return e.then=t.then.bind(t),e.catch=t.catch.bind(t),e.promise=t,e}(),this.renderMarker()}},{key:"componentDidUpdate",value:function(e){this.props.map===e.map&&this.props.position===e.position&&this.props.icon===e.icon||(this.marker&&this.marker.setMap(null),this.renderMarker())}},{key:"componentWillUnmount",value:function(){this.marker&&this.marker.setMap(null)}},{key:"renderMarker",value:function(){var e=this,t=this.props,n=(t.map,t.google),o=t.position,r=t.mapCenter;t.icon,t.label,t.draggable,t.title,t.info,t.url,t.id,t.description;if(!n)return null;var i=o||r;i instanceof n.maps.LatLng||(i=new n.maps.LatLng(i.lat,i.lng));var a={map:this.props.map,position:i,icon:this.props.icon,label:this.props.label,title:this.props.title,info:this.props.info,url:this.props.url,id:this.props.id,description:this.props.description,draggable:this.props.draggable};this.marker=new n.maps.Marker(a),f.forEach(function(t){e.marker.addListener(t,e.handleEvent(t))}),this.markerPromise.resolve(this.marker)}},{key:"getMarker",value:function(){return this.markerPromise}},{key:"handleEvent",value:function(e){var t=this;return function(n){var o=e;t.props[o]&&t.props[o](t.props,t.marker,n)}}},{key:"render",value:function(){return null}}]),t}();d.propTypes={position:a.a.object,map:a.a.object},f.forEach(function(e){return d.propTypes[e]=a.a.func}),d.defaultProps={name:"Marker"};var h=d,m=n(98),b=n(28),y=n.n(b),g=n(27),v=n(33);function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function w(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function L(e,t){return(L=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var E=n(1),M=["ready","click","dragend","rightclick","contextmenu","dblclick","maplongclick"],j=function(e){function t(e){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=(n=function(e,t){return!t||"object"!==k(t)&&"function"!=typeof t?O(e):t}(this,C(t).call(this,e))).props.initialCenter,r=o.lat,i=o.lng;return n.state={currentLocation:{lat:r,lng:i}},n.onPlaceSearch=n.onPlaceSearch.bind(O(O(n))),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&L(e,t)}(t,r.a.Component),function(e,t,n){t&&w(e.prototype,t),n&&w(e,n)}(t,[{key:"componentDidUpdate",value:function(e,t){if(e.google!==this.props.google&&this.loadMap(),t.currentLocation!==this.state.currentLocation&&this.recenterMap(),e.searchString!==this.props.searchString){var n={query:this.props.searchString,fields:["photos","formatted_address","name","rating","opening_hours","geometry"]};new google.maps.places.PlacesService(this.map).findPlaceFromQuery(n,this.onPlaceSearch)}}},{key:"onPlaceSearch",value:function(e,t){if(t==google.maps.places.PlacesServiceStatus.OK)for(var n=0;n<e.length;n++){var o=e[n],r=o.geometry.location.lat(),i=o.geometry.location.lng();this.setState({currentLocation:{lat:r,lng:i}})}}},{key:"componentDidMount",value:function(){var e=this;this.props.centerAroundCurrentLocation&&navigator&&navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(t){var n=t.coords;e.setState({currentLocation:{lat:n.latitude,lng:n.longitude}})}),this.loadMap()}},{key:"loadMap",value:function(){var e=this;if(this.props&&this.props.google){var t=this.props.google.maps,n=this.refs.map,o=y.a.findDOMNode(n),r=this.props,i=(r.initialCenter,r.zoom),a=this.state.currentLocation,c=a.lat,s=a.lng,l=new t.LatLng(c,s),u=Object.assign({},{center:l,zoom:i});this.map=new t.Map(o,u),M.forEach(function(t){e.map.addListener(t,e.handleEvent(t))}),t.event.trigger(this.map,"ready"),this.forceUpdate()}}},{key:"recenterMap",value:function(){var e=this.map,t=this.state.currentLocation,n=this.props.google.maps;if(e){var o=new n.LatLng(t.lat,t.lng);e.panTo(o)}}},{key:"handleEvent",value:function(e){var t,n=this,o=e;return function(e){t&&clearTimeout(t),t=setTimeout(function(){if(n.props[o]){var t={lat:e.latLng.lat(),lng:e.latLng.lng()};n.props.setLocation(t),n.props[o](n.props,n.map,e)}},0)}}},{key:"renderChildren",value:function(){var e=this,t=this.props.children;if(t&&!t.some(function(e){return!e}))return r.a.Children.map(t,function(t){return r.a.cloneElement(t,{map:e.map,google:e.props.google,mapCenter:e.state.currentLocation})})}},{key:"render",value:function(){return r.a.createElement("div",{id:"map",ref:"map"},"Loading map...",this.renderChildren())}}]),t}();j.propTypes={google:E.object,zoom:E.number,initialCenter:E.object,centerAroundCurrentLocation:E.bool,onMove:E.func},j.defaultProps={zoom:12,initialCenter:{lat:-36.855,lng:174.77},centerAroundCurrentLocation:!0,onMove:function(){}};var P=Object(g.b)(function(e){return{searchString:e.receiveSearchString}},function(e){return{setLocation:function(t){return e(Object(v.b)(t))}}})(j),S=n(92),_=n.n(S),N=(n(23),n(21));function I(e){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function W(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function T(e,t){return!t||"object"!==I(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function R(e){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function A(e,t){return(A=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var D=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),T(this,R(t).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&A(e,t)}(t,r.a.Component),function(e,t,n){t&&W(e.prototype,t),n&&W(e,n)}(t,[{key:"componentDidMount",value:function(){this.renderInfoWindow()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.google,o=t.map;n&&o&&(o!==e.map&&this.renderInfoWindow(),this.props.position!==e.position&&this.updatePosition(),this.props.children!==e.children&&this.updateContent(),this.props.visible===e.visible&&this.props.marker===e.marker&&this.props.position===e.position||(this.props.visible?this.openWindow():this.closeWindow()))}},{key:"renderInfoWindow",value:function(){var e=this.props,t=(e.map,e.google);e.mapCenter;if(t&&t.maps){var n=this.infowindow=new t.maps.InfoWindow({content:""});t.maps.event.addListener(n,"closeclick",this.onClose.bind(this)),t.maps.event.addListener(n,"domready",this.onOpen.bind(this)),t.maps.event.addListener(n,"click",this.onClick.bind(this))}}},{key:"onOpen",value:function(){this.props.onOpen&&this.props.onOpen()}},{key:"onClose",value:function(){this.props.onClose&&this.props.onClose()}},{key:"onClick",value:function(){this.props.onClick&&this.props.onClick()}},{key:"openWindow",value:function(){this.infowindow.setContent(this.infowindow.getContent()+'<div><button id="closeButton" type="button" className="button">'.concat(this.props.button,"</button></div>")),this.infowindow.open(this.props.map,this.props.marker),document.getElementById("closeButton").addEventListener("click",this.onClick.bind(this))}},{key:"updatePosition",value:function(){var e=this.props.position;e instanceof google.maps.LatLng||(e=e&&new google.maps.LatLng(e.lat,e.lng)),this.infowindow.setPosition(e)}},{key:"updateContent",value:function(){var e=this.renderChildren();this.infowindow.setContent(e)}},{key:"closeWindow",value:function(){this.infowindow.close()}},{key:"renderChildren",value:function(){var e=this.props.children;return _.a.renderToString(e)}},{key:"render",value:function(){return null}}]),t}();D.propTypes={children:a.a.element.isRequired,map:a.a.object,marker:a.a.object,position:a.a.object,info:a.a.object,url:a.a.object,visible:a.a.bool,id:a.a.object,button:a.a.object,onClose:a.a.func,onOpen:a.a.func,onClick:a.a.func},D.defaultProps={visible:!1};var x=Object(N.b)("strings")(D),U=n(15),z=n(94),F=n.n(z),q=n(128),B=n(130);function K(e){return(K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function J(){return(J=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function G(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function H(e){return(H=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Q(e,t){return(Q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function V(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var X={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",backgroundColor:"#1f1e1e"}},Y=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t){return!t||"object"!==K(t)&&"function"!=typeof t?V(e):t}(this,H(t).call(this,e))).state={showingInfoWindow:!1,activeMarker:{},selectedPlace:{},redirectId:null,name:"",title:"",description:"",error:null},n.onMarkerClick=n.onMarkerClick.bind(V(V(n))),n.onMapClicked=n.onMapClicked.bind(V(V(n))),n.onMapRightClicked=n.onMapRightClicked.bind(V(V(n))),n.openModal=n.openModal.bind(V(V(n))),n.closeModal=n.closeModal.bind(V(V(n))),n.onMoreInfo=n.onMoreInfo.bind(V(V(n))),n.submitNewLocation=n.submitNewLocation.bind(V(V(n))),n.handleChange=n.handleChange.bind(V(V(n))),n.reloadLocations=n.reloadLocations.bind(V(V(n))),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Q(e,t)}(t,r.a.Component),function(e,t,n){t&&G(e.prototype,t),n&&G(e,n)}(t,[{key:"componentDidMount",value:function(){this.reloadLocations()}},{key:"reloadLocations",value:function(){this.props.getAllLocations()}},{key:"openModal",value:function(){this.setState({modalIsOpen:!0})}},{key:"closeModal",value:function(){this.setState({modalIsOpen:!1})}},{key:"onMarkerClick",value:function(e,t,n){this.setState({selectedPlace:e,activeMarker:t,showingInfoWindow:!0})}},{key:"onMapClicked",value:function(e){this.state.showingInfoWindow&&this.setState({showingInfoWindow:!1,activeMarker:null})}},{key:"onMoreInfo",value:function(){this.setState({redirectId:this.state.selectedPlace.id})}},{key:"onMapRightClicked",value:function(){this.openModal()}},{key:"redirect",value:function(){if(this.state.redirectId)return r.a.createElement("div",null,"hi")}},{key:"handleChange",value:function(e){var t=e.target,n=t.name,o=t.value;this.setState(function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},n,o))}},{key:"submitNewLocation",value:function(e){var t=this,n={lat:this.props.newLocation.lat,lng:this.props.newLocation.lng,name:this.state.name,title:this.state.title,description:this.state.description};this.props.addLocation(n).then(function(){t.reloadLocations()}).catch(function(e){return t.setState({error:e.message})}),this.closeModal()}},{key:"render",value:function(){var e=this,t=this.props;t.ratings,t.userRating;if(this.state.redirectId)return r.a.createElement(q.a,{to:"/location/".concat(this.state.redirectId)});var n=this.props,o=n.t;n.i18n;return r.a.createElement(B.a,null,r.a.createElement(P,{google:this.props.google,style:{width:"100vh",height:"100vh"},click:this.onMapClicked,rightclick:this.onMapRightClicked,maplongclick:this.onMapRightClicked},this.props.locations.map(function(t){return r.a.createElement(h,{key:t.id,click:e.onMarkerClick,info:t.info,title:t.title,label:t.label,id:t.id,description:t.description,position:{lat:t.lat,lng:t.lng},url:t.url})}),r.a.createElement(x,J({},this.props,{defaultOptions:{disableAutoPan:!1},marker:this.state.activeMarker,visible:this.state.showingInfoWindow,selectedPlace:this.state.selectedPlace,stars:5,onClick:this.onMoreInfo,button:o("infoWindow.read")}),r.a.createElement("div",{className:"infoWindow"},r.a.createElement("h2",null,this.state.selectedPlace.title),r.a.createElement("img",{src:this.state.selectedPlace.url}),r.a.createElement("p",null,this.state.selectedPlace.info),r.a.createElement("p",null,this.state.selectedPlace.description))),r.a.createElement(F.a,{isOpen:this.state.modalIsOpen,onAfterOpen:this.afterOpenModal,onRequestClose:this.closeModal,style:X,contentLabel:o("addNewLocation.add_header"),ariaHideApp:!1},r.a.createElement("form",null,r.a.createElement("fieldset",{className:"addNewLocation"},r.a.createElement("h2",null,o("addNewLocation.add_header")),this.props.newLocation&&r.a.createElement("p",null,o("addNewLocation.latitude")," ",r.a.createElement("span",{className:"right"},this.props.newLocation.lat),r.a.createElement("br",null),o("addNewLocation.longitude")," ",r.a.createElement("span",{className:"right"},this.props.newLocation.lng)),r.a.createElement("label",{htmlFor:"name"},o("addNewLocation.place")," "),r.a.createElement("input",{type:"text",name:"name",id:"name",onChange:this.handleChange}),r.a.createElement("br",null),r.a.createElement("label",{htmlFor:"title"},o("addNewLocation.title")," "),r.a.createElement("input",{type:"text",name:"title",id:"title",onChange:this.handleChange}),r.a.createElement("br",null),r.a.createElement("label",{htmlFor:"description"},o("addNewLocation.description")," "),r.a.createElement("input",{type:"description",name:"description",id:"description",onChange:this.handleChange}),r.a.createElement("br",null),r.a.createElement("button",{type:"button",className:"button",onClick:this.submitNewLocation},o("addNewLocation.submit")),r.a.createElement("button",{type:"button",className:"button",onClick:this.closeModal},o("addNewLocation.cancel")))))))}}]),t}();var Z=googleApiKey,$=Object(m.GoogleApiWrapper)({apiKey:"".concat(Z)})(Y);t.default=Object(N.b)("strings")(Object(g.b)(function(e){return{locations:e.receiveLocations,newLocation:e.setNewLocation,language:e.receiveLanguage}},function(e){return{getAllLocations:function(){return e(Object(U.g)())},addLocation:function(t){return e(Object(U.e)(t))}}})($))}}]);
//# sourceMappingURL=3.bundle.js.map